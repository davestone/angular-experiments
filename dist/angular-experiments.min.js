/*! angular-experiments 05-12-2013 */
!function(){"use strict";angular.module("ketch.experiments",[]).provider("Experiments",function(){this.cookieName="angular-experiments",this.store={},this.logImpression=function(){},this.logResult=function(){},this.set=function(a,b){this[a]=b},this.$get=["$cookieStore",function(a){return{cookieName:this.cookieName,store:a,logImpression:logger.logImpression,logResult:this.logResult,logWhitelist:[]}}]}).directive("experiment",["Experiments",function(a){return{restrict:"E",replace:!1,compile:function(){return function(b,c,d){var e=d.id,f=a.store.get(a.cookieName)||{},g=c.children(),h=f[e];void 0===h&&(h=g[Math.floor(Math.random()*g.length)].id,f[e]=h,a.store.put(a.cookieName,f),a.logWhitelist.push(e),a.logImpression(e,h)),angular.forEach(g,function(a){a.id!=h&&a.remove()})}}}}]).directive("experimentEnd",["Experiments",function(a){return{restrict:"A",replace:!1,link:function(b,c,d){var e=d.experimentEnd,f=a.logWhitelist.indexOf(e);f>-1&&(delete a.logWhitelist[f],c.on("click",function(){var b=a.store.get(a.cookieName)[d.experimentEnd];a.logResult(e,b)}))}}}])}();